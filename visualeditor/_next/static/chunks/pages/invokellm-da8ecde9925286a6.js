(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[165],{55460:(e,n,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/invokellm",function(){return t(31682)}])},31682:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>I});var r=t(74848),l=t(96540),s=t(86715),o=t(70848),a=t(56871),i=t(11849),c=t(67217),u=t(18947),d=t(28018),p=t(10658),h=t(83727),m=t(74472),g=t(84577),x=t(44404);function f(){let e=(0,g._)(["\n    h2 {\n        font-size: 1.3em;\n        font-weight: bold;\n    }\n\n    button {\n        background-color: transparent;\n        background-repeat: no-repeat;\n        border: none;\n        cursor: pointer;\n        overflow: hidden;\n        outline: none;    \n    }\n    div {\n        margin-left: 10px;\n        width: 95%;\n    }\n    table, th, td {\n        border: 2px solid;\n        border-color: #DEE2E6;\n        border-radius: 10px;\n    }\n\n    p {\n        margin-left: 7px;\n        margin-bottom: -2px;\n    }\n"]);return f=function(){return e},e}let y=x.Ay.div(f()),A=e=>{let{title:n,content:t}=e,s=()=>{a(e=>!e)},[o,a]=(0,l.useState)(!0),i=null;i=o?(0,r.jsxs)("button",{onClick:s,children:[" ▼ ",n," "]}):(0,r.jsxs)("button",{onClick:s,children:[" ▶ ",n," "]}),t.startsWith("</p>")&&(t=t.slice(4)),t.endsWith("<p>")&&(t=t.slice(0,-3));let c=(0,r.jsx)("div",{dangerouslySetInnerHTML:{__html:t}});return(0,r.jsxs)(y,{children:[i,o?c:null]})};function b(){let e=(0,g._)(["\n  0% {\n    background-color: white;\n  }\n  100% {\n    background-color: black;\n  }\n"]);return b=function(){return e},e}function j(){let e=(0,g._)(["\n  from {\n    transform: rotateY(180deg) scale(.25);\n    opacity: 0;\n  }\n\n  to {\n    transform: rotateY(0deg) scale(1);\n    opacity: 1;\n  }\n"]);return j=function(){return e},e}function w(){let e=(0,g._)(["\n  from {\n    opacity: 0;\n  }\n\n  to {\n    opacity: 1;\n  }\n"]);return w=function(){return e},e}function _(){let e=(0,g._)(["\n  from {\n    transform: scale(1);\n    opacity: 1;\n  }\n\n  to {\n    transform: scale(.25);\n    opacity: 0;\n  }\n"]);return _=function(){return e},e}let v=(0,x.i7)(b());(0,x.i7)(j()),(0,x.i7)(w()),(0,x.i7)(_());var k=t(86851),S=t(14817),E=t(49),T=t(52333),$=t(50695);function L(){let e=(0,g._)(['\n    p:last-of-type::after {\n        position: relative;\n        top: 3px;\n        content: "";\n        width: 10px;\n        height: 18px;\n        background: #1c1406;\n        display: inline-block;\n        animation: '," 1.5s steps(2) infinite;\n    }\n      \n    p {\n        margin-left: 7px;\n        margin-bottom: -2px;\n        white-space: pre-line\n    }\n"]);return L=function(){return e},e}function C(){let e=(0,g._)(["      \n    p {\n        margin-left: 7px;\n        margin-bottom: -2px;\n        white-space: pre-line\n    }\n"]);return C=function(){return e},e}t(34811);let D=x.Ay.div(L(),v),P=x.Ay.div(C()),B=e=>{let{content:n,active:t}=e;return n.includes("[")&&(n=function(e){let n=[];e=e.replace(/(```[\s\S]*?```|`[^`\n]+`)/g,(e,t)=>(n.push(t),"<<CODE_BLOCK_".concat(n.length-1,">>")));let t=[];return e=(e=(e=(e=(e=(e=e.replace(/(\$\$[\s\S]*?\$\$|\\\[[\s\S]*?\\\]|\\\(.*?\\\))/g,e=>(t.push(e),"<<LATEX_".concat(t.length-1,">>")))).replace(/\$(?=\d)/g,"\\$")).replace(/<<LATEX_(\d+)>>/g,(e,n)=>t[parseInt(n)])).replace(/<<CODE_BLOCK_(\d+)>>/g,(e,t)=>n[parseInt(t)])).replace(/(```[\S\s]*?```|`.*?`)|\\\[([\S\s]*?[^\\])\\]|\\\((.*?)\\\)/g,(e,n,t,r)=>null!=n?n:null!=t?"$$".concat(t,"$$"):null!=r?"$".concat(r,"$"):e)).replaceAll("$\\ce{","$\\\\ce{").replaceAll("$\\pu{","$\\\\pu{")}(n)),t?(0,r.jsx)(D,{children:(0,r.jsx)(E.o,{remarkPlugins:[k.A],rehypePlugins:[S.A],components:{code(e){let{children:n,className:t,node:l,...s}=e,o=/language-(\w+)/.exec(t||"");return o?(0,r.jsx)(T.A,{...s,PreTag:"div",children:String(n).replace(/\n$/,""),language:o[1],style:$.iU}):(0,r.jsx)("code",{...s,className:t,children:n})}},children:n})}):(0,r.jsx)(P,{children:(0,r.jsx)(E.o,{remarkPlugins:[k.A],rehypePlugins:[S.A],components:{code(e){let{children:n,className:t,node:l,...s}=e,o=/language-(\w+)/.exec(t||"");return o?(0,r.jsx)(T.A,{...s,PreTag:"div",children:String(n).replace(/\n$/,""),language:o[1],style:$.iU}):(0,r.jsx)("code",{...s,className:t,children:n})}},children:n})})};class R extends Error{}let W="</think>",I=()=>{let e=(0,s.useRouter)(),[n,t]=(0,l.useState)(),[g,x]=(0,l.useState)(!1),[f,y]=(0,l.useState)(""),[b,j]=(0,l.useState)(""),[w,_]=(0,l.useState)({show:!1,title:"Title Here",message:"This is a message."}),[v,k]=(0,l.useState)(!1),S=(0,l.useRef)([]),E=(0,l.useRef)(!1),T=(0,l.useRef)(null);(0,l.useEffect)(()=>{var e;null===(e=T.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),(0,l.useEffect)(()=>{if(e.isReady)try{let{smooth:n}=e.query;void 0!==n&&(E.current="true"===n)}catch(e){console.log("error getting input argument.")}},[e.isReady]),(0,l.useEffect)(()=>{let e=null;return E.current&&(console.log("start streaming interval"),e=setInterval(()=>{S.current.length>0&&y(e=>e+S.current.shift())},100)),()=>{null!=e&&clearInterval(e)}},[E.current]);let $=async e=>{let n=Date.now(),t=-1;j(""),k(!0);let r="";r="".concat("http://localhost:8081","/").concat("lurawi","/message");let l=JSON.stringify({uid:"dummyid",name:"dummyname",data:{message:e.prompt,stream:!0}}),s={"Content-Type":"application/json","X-LURAWI-API-KEY":"lurawi_api_key","X-Accel-Buffering":"no"},o="";fetch(r,{method:"POST",headers:s,body:l}).then(e=>e.json()).then(e=>{if("success"===e.status){if("stream_endpoint"in e){let r=e.stream_endpoint;"stream_access_key"in e&&(s["X-LURAWI-API-KEY"]=e.stream_access_key),(0,m.y)(r,{method:"GET",headers:s,credentials:"same-origin",onmessage(e){-1==t&&(t=Date.now(),console.log("delay to the start stream ".concat(t-n)));let r=e.data.replaceAll("<br/>","  \n");if(r.startsWith("<think>"))o=r=r.slice(8);else if((o+=r).includes(W)){let[e,n]=o.split(W);j(e.trim()),y(""),o=r=n.trim()}E.current?S.current.push(r):y(e=>e+r)},onerror(e){if(e instanceof R)throw e;return console.log("streaming error ".concat(e)),100},onclose(){console.log("total streaming time ".concat(Date.now()-t)),k(!1)}})}else y(e.response),k(!1)}else _({show:!0,status:"error",title:"Something went wrong!",message:e.message})}).catch(e=>{k(!1),_({show:!0,status:"error",title:"Something went wrong!",message:e.message})})},L=async e=>{e.preventDefault(),y("");let n=e.currentTarget,t=new FormData(n);if(n.checkValidity()){let e={prompt:t.get("prompt"),streaming:!0,temperature:parseFloat(t.get("temperature"))};await $(e)}else e.preventDefault(),e.stopPropagation();x(!0)};return(0,r.jsx)("div",{style:{backgroundColor:"#F1F7FB",height:"100%",width:"100%",fontFamily:"Gilroy-Regular"},children:(0,r.jsxs)(o.A,{style:{maxWidth:"800px"},children:[(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.A,{children:(0,r.jsx)(i.A,{style:{textAlign:"center"},children:(0,r.jsx)("h1",{style:{margin:"1em 0 1em 0",fontSize:"1.5em",fontFamily:"Gilroy-SemiBold"},children:"Welcome to Lurawi Test Console!"})})}),(0,r.jsx)(a.A,{style:{marginBottom:"2em"},children:(0,r.jsx)(i.A,{style:{marginLeft:"auto",marginRight:"auto",maxWidth:"800px",marginTop:"1em"},children:(0,r.jsxs)(c.A,{body:!0,style:{border:"none",boxShadow:"0 1px 2px rgba(0,0,0,0.04), 0 2px 4px rgba(0,0,0,0.04), 0 4px 8px rgba(0,0,0,0.04), 0 8px 16px rgba(0,0,0,0.04),0 16px 32px rgba(0,0,0,0.04), 0 32px 64px rgba(0,0,0,0.04)"},children:[(0,r.jsxs)(a.A,{style:{marginBottom:"0.8em"},children:[(0,r.jsx)(u.A.Group,{as:i.A,children:(0,r.jsx)(u.A.Label,{style:{fontWeight:"bold"},children:" \uD83D\uDDA8 Output from Agent"})}),(0,r.jsxs)(o.A,{style:{height:"400px",maxHeight:"400px",overflowY:"auto"},children:[b?(0,r.jsx)(A,{title:"Think",content:b}):null,(0,r.jsx)(B,{content:f,active:S.current.length>0||v}),(0,r.jsx)("div",{ref:T})]})]}),(0,r.jsxs)(u.A,{noValidate:!0,validated:g,onSubmit:L,children:[(0,r.jsx)(a.A,{style:{marginBottom:"0.8em"},children:(0,r.jsxs)(u.A.Group,{as:i.A,children:[(0,r.jsx)(u.A.Label,{style:{fontWeight:"bold"},children:" ⌨ Enter your message"}),(0,r.jsx)(u.A.Control,{name:"prompt",required:!0,type:"text",placeholder:"Please enter your text here",defaultValue:"",onChange:e=>t({...n,prompt:e.target.value}),onFocus:e=>e.target.select()})]})}),(0,r.jsx)(a.A,{style:{marginBottom:"0.8em"},children:(0,r.jsx)(d.A,{style:{marginLeft:"auto",marginRight:"auto",maxWidth:"140px",marginTop:"0.8em"},type:"submit",children:v||S.current.length>0?(0,r.jsx)(p.A,{style:{width:"20px",height:"20px"},animation:"border",role:"status"}):"Submit"})})]})]})})})]}),(0,r.jsxs)(h.A,{centered:!0,show:w.show,onHide:()=>_({show:!1}),children:[(0,r.jsx)(h.A.Header,{closeButton:!0,children:(0,r.jsx)(h.A.Title,{children:w.title})}),(0,r.jsx)(h.A.Body,{children:w.message})]})]})})}}},e=>{var n=n=>e(e.s=n);e.O(0,[611,170,603,636,593,792],()=>n(55460)),_N_E=e.O()}]);